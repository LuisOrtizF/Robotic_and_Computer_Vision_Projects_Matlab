<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="114,1" id="srcline1"> 1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">chessboard</span> = initChessboard(<span class="var type1" id="S3T3U6">corners</span>,<span class="var type1" id="S4T5U7">idx</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="114,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,4" id="srcline4"> 4</a></span><span class="line">    <span class="comment">% return if not enough corners</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,5" id="srcline5"> 5</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U4"><span class="mxinfo " id="T5:U5">size(<span class="mxinfo " id="T1:U6"><span class="var type1" id="S3T3U14">corners</span>.p</span>,1)</span>&lt;<span class="mxinfo " id="T5:U8">9</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="114,6" id="srcline6"> 6</a></span><span class="line">      <span class="mxinfo " id="T1:U9"><span class="var type1" id="S2T1U20">chessboard</span> = <span class="mxinfo " id="T66:U11">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,7" id="srcline7"> 7</a></span><span class="line">      <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,8" id="srcline8"> 8</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,10" id="srcline10">10</a></span><span class="line">    <span class="comment">% init chessboard hypothesis</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T1:U12"><span class="var type1" id="S2T1U26">chessboard</span> = <span class="mxinfo " id="T25:U14">zeros(<span class="mxinfo " id="T5:U15">3</span>,<span class="mxinfo " id="T5:U16">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,12" id="srcline12">12</a></span><span class="line">    coder.varsize(<span class="string">'chessboard'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,13" id="srcline13">13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="114,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T46:U17"><span class="var type1" id="S8T46U39">dist1</span>=<span class="mxinfo " id="T46:U19">zeros(<span class="mxinfo " id="T5:U20">1</span>,<span class="mxinfo " id="T5:U21">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T117:U22"><span class="var type1" id="S9T117U46">dist2</span>=<span class="mxinfo " id="T117:U24">zeros(<span class="mxinfo " id="T5:U25">1</span>,<span class="mxinfo " id="T5:U26">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,17" id="srcline17">17</a></span><span class="line">    <span class="comment">% extract feature index and orientation (central element)</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T98:U27"><span class="var type1" id="S10T98U53">v1</span> = <span class="mxinfo " id="T98:U29"><span class="mxinfo " id="T1:U30"><span class="var type1" id="S3T3U56">corners</span>.v1</span>(<span class="var type1" id="S4T5U58">idx</span>,<span class="mxinfo " id="T86:U33">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T98:U34"><span class="var type1" id="S11T98U62">v2</span> = <span class="mxinfo " id="T98:U36"><span class="mxinfo " id="T1:U37"><span class="var type1" id="S3T3U65">corners</span>.v2</span>(<span class="var type1" id="S4T5U67">idx</span>,<span class="mxinfo " id="T86:U40">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T5:U41"><span class="mxinfo " id="T5:U42"><span class="var type1" id="S2T1U72">chessboard</span>(<span class="mxinfo " id="T5:U44">2</span>,<span class="mxinfo " id="T5:U45">2</span>)</span> = <span class="var type1" id="S4T5U75">idx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,22" id="srcline22">22</a></span><span class="line">    <span class="comment">% find left/right/top/bottom neighbors</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,23" id="srcline23">23</a></span><span class="line">    [<span class="mxinfo " id="T5:U47"><span class="var type1" id="S2T1U80">chessboard</span>(<span class="mxinfo " id="T5:U49">2</span>,<span class="mxinfo " id="T5:U50">3</span>)</span>,<span class="mxinfo " id="T5:U51"><span class="var type1" id="S8T46U84">dist1</span>(<span class="mxinfo " id="T26:U53">1</span>)</span>] = <span class="fcn" id="F615N15:B87">directionalNeighbor</span>(<span class="var type1" id="S4T5U88">idx</span>,+<span class="var type1" id="S10T98U90">v1</span>,<span class="var type1" id="S2T1U91">chessboard</span>,<span class="var type1" id="S3T3U92">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,24" id="srcline24">24</a></span><span class="line">    [<span class="mxinfo " id="T5:U58"><span class="var type1" id="S2T1U97">chessboard</span>(<span class="mxinfo " id="T5:U60">2</span>,<span class="mxinfo " id="T5:U61">1</span>)</span>,<span class="mxinfo " id="T5:U62"><span class="var type1" id="S8T46U101">dist1</span>(<span class="mxinfo " id="T26:U64">2</span>)</span>] = <span class="fcn" id="F615N15:B104">directionalNeighbor</span>(<span class="var type1" id="S4T5U105">idx</span>,<span class="mxinfo " id="T98:U66">-<span class="var type1" id="S10T98U107">v1</span></span>,<span class="var type1" id="S2T1U108">chessboard</span>,<span class="var type1" id="S3T3U109">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,25" id="srcline25">25</a></span><span class="line">    [<span class="mxinfo " id="T5:U70"><span class="var type1" id="S2T1U114">chessboard</span>(<span class="mxinfo " id="T5:U72">3</span>,<span class="mxinfo " id="T5:U73">2</span>)</span>,<span class="mxinfo " id="T5:U74"><span class="var type1" id="S9T117U118">dist2</span>(<span class="mxinfo " id="T26:U76">1</span>)</span>] = <span class="fcn" id="F615N15:B121">directionalNeighbor</span>(<span class="var type1" id="S4T5U122">idx</span>,+<span class="var type1" id="S11T98U124">v2</span>,<span class="var type1" id="S2T1U125">chessboard</span>,<span class="var type1" id="S3T3U126">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,26" id="srcline26">26</a></span><span class="line">    [<span class="mxinfo " id="T5:U81"><span class="var type1" id="S2T1U131">chessboard</span>(<span class="mxinfo " id="T5:U83">1</span>,<span class="mxinfo " id="T5:U84">2</span>)</span>,<span class="mxinfo " id="T5:U85"><span class="var type1" id="S9T117U135">dist2</span>(<span class="mxinfo " id="T26:U87">2</span>)</span>] = <span class="fcn" id="F615N15:B138">directionalNeighbor</span>(<span class="var type1" id="S4T5U139">idx</span>,<span class="mxinfo " id="T98:U89">-<span class="var type1" id="S11T98U141">v2</span></span>,<span class="var type1" id="S2T1U142">chessboard</span>,<span class="var type1" id="S3T3U143">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,28" id="srcline28">28</a></span><span class="line">    <span class="comment">% find top-left/top-right/bottom-left/bottom-right neighbors</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,29" id="srcline29">29</a></span><span class="line">    [<span class="mxinfo " id="T5:U93"><span class="var type1" id="S2T1U148">chessboard</span>(<span class="mxinfo " id="T5:U95">1</span>,<span class="mxinfo " id="T5:U96">1</span>)</span>,<span class="mxinfo " id="T5:U97"><span class="var type1" id="S9T117U152">dist2</span>(<span class="mxinfo " id="T26:U99">3</span>)</span>] = <span class="fcn" id="F615N15:B155">directionalNeighbor</span>(<span class="mxinfo " id="T5:U100"><span class="var type1" id="S2T1U157">chessboard</span>(<span class="mxinfo " id="T5:U102">2</span>,<span class="mxinfo " id="T5:U103">1</span>)</span>,<span class="mxinfo " id="T98:U104">-<span class="var type1" id="S11T98U161">v2</span></span>,<span class="var type1" id="S2T1U162">chessboard</span>,<span class="var type1" id="S3T3U163">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,30" id="srcline30">30</a></span><span class="line">    [<span class="mxinfo " id="T5:U108"><span class="var type1" id="S2T1U168">chessboard</span>(<span class="mxinfo " id="T5:U110">3</span>,<span class="mxinfo " id="T5:U111">1</span>)</span>,<span class="mxinfo " id="T5:U112"><span class="var type1" id="S9T117U172">dist2</span>(<span class="mxinfo " id="T26:U114">4</span>)</span>] = <span class="fcn" id="F615N15:B175">directionalNeighbor</span>(<span class="mxinfo " id="T5:U115"><span class="var type1" id="S2T1U177">chessboard</span>(<span class="mxinfo " id="T5:U117">2</span>,<span class="mxinfo " id="T5:U118">1</span>)</span>,+<span class="var type1" id="S11T98U181">v2</span>,<span class="var type1" id="S2T1U182">chessboard</span>,<span class="var type1" id="S3T3U183">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,31" id="srcline31">31</a></span><span class="line">    [<span class="mxinfo " id="T5:U122"><span class="var type1" id="S2T1U188">chessboard</span>(<span class="mxinfo " id="T5:U124">1</span>,<span class="mxinfo " id="T5:U125">3</span>)</span>,<span class="mxinfo " id="T5:U126"><span class="var type1" id="S9T117U192">dist2</span>(<span class="mxinfo " id="T26:U128">5</span>)</span>] = <span class="fcn" id="F615N15:B195">directionalNeighbor</span>(<span class="mxinfo " id="T5:U129"><span class="var type1" id="S2T1U197">chessboard</span>(<span class="mxinfo " id="T5:U131">2</span>,<span class="mxinfo " id="T5:U132">3</span>)</span>,<span class="mxinfo " id="T98:U133">-<span class="var type1" id="S11T98U201">v2</span></span>,<span class="var type1" id="S2T1U202">chessboard</span>,<span class="var type1" id="S3T3U203">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,32" id="srcline32">32</a></span><span class="line">    [<span class="mxinfo " id="T5:U137"><span class="var type1" id="S2T1U208">chessboard</span>(<span class="mxinfo " id="T5:U139">3</span>,<span class="mxinfo " id="T5:U140">3</span>)</span>,<span class="mxinfo " id="T5:U141"><span class="var type1" id="S9T117U212">dist2</span>(<span class="mxinfo " id="T26:U143">6</span>)</span>] = <span class="fcn" id="F615N15:B215">directionalNeighbor</span>(<span class="mxinfo " id="T5:U144"><span class="var type1" id="S2T1U217">chessboard</span>(<span class="mxinfo " id="T5:U146">2</span>,<span class="mxinfo " id="T5:U147">3</span>)</span>,+<span class="var type1" id="S11T98U221">v2</span>,<span class="var type1" id="S2T1U222">chessboard</span>,<span class="var type1" id="S3T3U223">corners</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="114,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,34" id="srcline34">34</a></span><span class="line">    <span class="comment">% initialization must be homogenously distributed</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,35" id="srcline35">35</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U151">any(<span class="mxinfo " id="T116:U152">isinf(<span class="var type1" id="S8T46U233">dist1</span>)</span>)</span> || <span class="mxinfo " id="T7:U154">any(<span class="mxinfo " id="T118:U155">isinf(<span class="var type1" id="S9T117U238">dist2</span>)</span>)</span> || <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,36" id="srcline36">36</a></span><span class="line">       <span class="mxinfo " id="T7:U157"><span class="mxinfo " id="T5:U158"><span class="mxinfo " id="T5:U159">std(<span class="var type1" id="S8T46U243">dist1</span>)</span>/<span class="mxinfo " id="T5:U161">mean(<span class="var type1" id="S8T46U246">dist1</span>)</span></span>&gt;<span class="mxinfo " id="T5:U163">0.3</span></span> || <span class="mxinfo " id="T7:U164"><span class="mxinfo " id="T5:U165"><span class="mxinfo " id="T5:U166">std(<span class="var type1" id="S9T117U252">dist2</span>)</span>/<span class="mxinfo " id="T5:U168">mean(<span class="var type1" id="S9T117U255">dist2</span>)</span></span>&gt;<span class="mxinfo " id="T5:U170">0.3</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="114,37" id="srcline37">37</a></span><span class="line">      <span class="mxinfo " id="T1:U171"><span class="var type1" id="S2T1U259">chessboard</span> = <span class="mxinfo " id="T66:U173">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,38" id="srcline38">38</a></span><span class="line">      <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="114,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,40" id="srcline40">40</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="114,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="114,42" id="srcline42">42</a></span><span class="line"></span></span>
</pre>
